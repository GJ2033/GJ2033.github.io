<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="反射, Hexo">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>反射 | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/15.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">反射</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-06-17
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.1k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="IO流"><a href="#IO流" class="headerlink" title="IO流"></a>IO流</h1><p>在java中，可以向其中读取一个字节序列的对象叫做输入流，可以向其中写入一个字节序列的对象称作输出流。处理字节单位的输入输出流为InputStream和OutputStream，处理字符单位的抽象类为Reader和Writer。</p>
<h2 id="1-输入输出流"><a href="#1-输入输出流" class="headerlink" title="1. 输入输出流"></a>1. 输入输出流</h2><h2 id="1-1-读写字节"><a href="#1-1-读写字节" class="headerlink" title="1.1 读写字节"></a>1.1 读写字节</h2><p>典型的方法如下：</p>
<p>abstract int read()<br>该方法读入一个字节，并返回读入的字节，遇到输入源结尾时返回-1。</p>
<p>abstract void write(int b)<br>该方法写出一个字节</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">API java.io.InputStream
abstract int read()
int read(byte[] b)
读入一个字节数组，返回实际读入的字节数，或者在碰到输入流的结尾时返回-1。最多读入b.length个字节。
int read(byte[] b, int off, int len)
long skip(long n)
int available()
返回在不阻塞的情况下可获取的字节数。
void close()
关闭这个输入流

API java.io.OutputStream
abstract void write(int n)
写出一个字节的数据
void write(byte[] b)
void write(byte[] b, int off, int len)
void close()
void flush()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Java包含各种输入输出流，处理字节流使用InputStream/OutputStream及其子类，常用的如FileInputStream/FileOutputStream，BufferedInputStream/BufferedOutputStream，DataInputStream/DataOutputStream可以以二进制格式读写基本java类型。</p>
<p>处理字符流使用Reader\Writer及其子类，同样的有FileReader\FileWriter，BufferedReader\BufferedWriter，将字节流转为字符流的类InputStreamReader\OutPutStreamReader。</p>
<h3 id="1-2-流过滤器"><a href="#1-2-流过滤器" class="headerlink" title="1.2 流过滤器"></a>1.2 流过滤器</h3><p>FileInputStream\FileOutputStream提供了附着在磁盘文件上的输入流输出流，只需向其构造器提供文件名或文件的完整路劲名。例如：</p>
<p><code>FileInputStream fin = new FileInputStream(&quot;D:\Files\IntelliJ IDEA\test\src\\test.dat&quot;)</code></p>
<p>从fin对象只能读入字节或字节数组，如果我们有DataInputStream，那么就只能读入数值类型：</p>
<p><code>DataInputStream din = ...; double x = din.readDouble();</code></p>
<p>FilterInputStream\FilterOutputStream类的子类向用于处理字节的输入输出流添加额外的功能，比如想使用缓冲机制，以及用于文件的数据输入方法，就需要使用下面的构造器序列：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">DataInputStream din &#x3D; new DataInputStream(
    new BufferedInputStream(
        new FileInputStream(&quot;test.dat&quot;)
    )
);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>从一个zip压缩文件中使用下面的输入流序列来读入数字</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">ZipInputStream zin &#x3D; new ZipInputStream(new FileInputStream(&quot;test.zip&quot;));
DataInputStream din &#x3D; new DataInputStream(zin);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>将DataInputStream置于构造链的最后是因为我们需要使用DataInputStream的方法。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">API java.io.FileInputStream
FileInputStream(String name)
FileInputStream(File file)

API java.io.FileOutputStream
FileOutputStream(String name)
FileOutputStream(String name, boolean append)
FileOutputStream(File file)
FileOutputStream(File file, boolean append)

API java.io.BufferedInputStream
BufferedInputStream(InputStream in)
带缓冲区的输入流在从流中读入字符时，不会每次都对设备访问
BufferedOutputStream(OutputStream out)

API java.io.PushbackInputStream
PushbackInputStream(InputStream in)
PushbackInputputStream(InputStream in, int size)
void unread(int b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="2-文本输入与输出"><a href="#2-文本输入与输出" class="headerlink" title="2. 文本输入与输出"></a>2. 文本输入与输出</h2><p>OutputStreamWriter类将使用选定的字符编码方式，把Unicode码元的输出流转换为字节流。InputStreamReader类将包含字节的输入流转换为可以产生Unicode码元的读入器。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">Reader in &#x3D; new InputStreamReader(new FileInputStream(&quot;data.txt&quot;), StandardCharsets.UTF_8);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="2-1-写出文本输出"><a href="#2-1-写出文本输出" class="headerlink" title="2.1 写出文本输出"></a>2.1 写出文本输出</h3><p>对于文本输出使用PrintWriter，该类拥有以文本格式打印字符串和数字的方法，同时有一个将PrintWriter链接到FileWriter的便捷方法，下面的语句：</p>
<p><code>PrintWriter out = new PrintWriter(&quot;test.txt&quot;, &quot;UTF-8&quot;);</code></p>
<p>等同于：</p>
<p><code>PrintWriter out = new PrintWriter(     new FileOutputStream(&quot;test.txt&quot;, &quot;UTF-8&quot;) );</code></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">String name &#x3D; &quot;Harry Hacker &quot;;
double salary &#x3D; 75000;
out.print(name);
out.println(salary);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>将把字符”Harry Hacker 75000.0”写入到输出器out，之后字符被转换为字节并最终写入test.txt文件中。</p>
<h3 id="2-2-读入文本输入"><a href="#2-2-读入文本输入" class="headerlink" title="2.2 读入文本输入"></a>2.2 读入文本输入</h3><p>可以从输入流中构造Scanner对象，也可以将短小的文本文件以这种方式读入到一个字符串中：</p>
<p><code>String content = new String(Files.readAllBytes(path), charset)</code></p>
<p>如果想将文件一行一行地读入，可以调用：</p>
<p><code>List&lt;String&gt; lines = Files.readAllLines(path, charset);</code></p>
<p>如果文件太大，那么可以将行惰性处理为一个Stream<String>对象：</p>
<p><code>try(Stream&lt;String&gt; lines = Files.lines(path, charset))&#123;     ... &#125;</code></p>
<p>早期处理文本输入的唯一方式就是通过BufferedReader类，它的readLine方法会产生一行文本，在无法获得更多的输入时返回null。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">InputStream inputstream &#x3D; ...;
try(BufferedReader in &#x3D; new BufferedReader(
    new InputStreamReader(inputstream,
                            StandardCharsets.UTF_8)))
&#123;
    String line;
    while((line &#x3D; in.readLine()) !&#x3D; null)
    &#123;
        do something with line
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-3-以文本格式存储对象"><a href="#2-3-以文本格式存储对象" class="headerlink" title="2.3 以文本格式存储对象"></a>2.3 以文本格式存储对象</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java">package io;

import io.Employee;

import java.io.*;
import java.time.LocalDate;
import java.util.Scanner;

public class TestFileTest &#123;
    public static void main(String[] args) throws IOException &#123;
        Employee[] staff &#x3D; new Employee[3];
        staff[0] &#x3D; new Employee(&quot;Carl Cracker&quot;, 75000, 1987, 12, 15);
        staff[1] &#x3D; new Employee(&quot;Harry Hacker&quot;, 50000, 1989, 10, 1);
        staff[2] &#x3D; new Employee(&quot;Tony Tester&quot;, 40000, 1990, 3, 15);

        try (PrintWriter out &#x3D; new PrintWriter(&quot;employee.dat&quot;, &quot;UTF-8&quot;)) &#123;
            writeData(staff, out);
        &#125;

        try (Scanner in &#x3D; new Scanner(new FileInputStream(&quot;employee.dat&quot;), &quot;UTF-8&quot;)) &#123;
            Employee[] newStaff &#x3D; readData(in);

            for (Employee e : newStaff) &#123;
                System.out.println(e);
            &#125;
        &#125;
    &#125;

    private static void writeData(Employee[] employees, PrintWriter out) throws IOException
    &#123;
        out.println(employees.length);

        for (Employee e:employees)&#123;writeEmployee(out, e);&#125;
    &#125;

    private static Employee[] readData(Scanner in)
    &#123;
        int n &#x3D; in.nextInt();
        in.nextLine();

        Employee[] employees &#x3D; new Employee[n];
        for (int i&#x3D;0; i &lt; n; i++)&#123;
            employees[i] &#x3D; readEmployee(in);
        &#125;
        return employees;
    &#125;

    public static void writeEmployee(PrintWriter out, Employee e)
    &#123;
        out.println(e.getName() + &quot;|&quot; + e.getSalary() + &quot;|&quot; + e.getHireDay());
    &#125;

    public static Employee readEmployee(Scanner in)
    &#123;
        String line &#x3D; in.nextLine();
        String[] tokens &#x3D; line.split(&quot;\\|&quot;);
        String name &#x3D; tokens[0];
        double salary &#x3D; Double.parseDouble(tokens[1]);
        LocalDate hireDay &#x3D; LocalDate.parse(tokens[2]);
        int year &#x3D; hireDay.getYear();
        int month &#x3D; hireDay.getMonthValue();
        int day &#x3D; hireDay.getDayOfMonth();
        return new Employee(name, salary, year, month, day);
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-读写二进制数据"><a href="#3-读写二进制数据" class="headerlink" title="3. 读写二进制数据"></a>3. 读写二进制数据</h2><p>以二进制格式传递数据相比文本格式更加高效。</p>
<h3 id="3-1-DateInput和DataOutput接口"><a href="#3-1-DateInput和DataOutput接口" class="headerlink" title="3.1 DateInput和DataOutput接口"></a>3.1 DateInput和DataOutput接口</h3><p>DataOutput接口定义了下面用于以二进制格式写数组、字符、boolean值和字符串的方法：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">writeChars
writeByte
writeInt
writeShort
writeLong
writeFloat
writeDouble
writeChar
writeBoolean
writeUTF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>如writeInt总是将一个整数写出为4字节的二进制数量值，不管它有多少位，writeDouble总是将一个double值写出为8字节的二进制数量值。</p>
<p>为了读回数据，可以使用DataInput接口中的下列方法：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">readInt
readShort
readLong
readFloat
readDouble
readChar
readBoolean
readUTF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>DataInputStream类实现了DataInput接口，为了从文件中读入二进制数据，可以将DataInputStream与某个字节源相组合，如FileInputStream：</p>
<p><code>DataInputStream in = new DataInputStream(new FileInputStream(&quot;employee.dat&quot;))</code></p>
<p>同样DataOutputStream类实现了DataOutput接口。</p>
<h3 id="3-2-随机访问文件"><a href="#3-2-随机访问文件" class="headerlink" title="3.2 随机访问文件"></a>3.2 随机访问文件</h3><p>RandomAccessFile类可以在文件中的任何位置查找和写入数据，磁盘文件都是随机访问的，但是与网络套接字通信的输入\输出流不是。通过字符串’r’或者’rw’指定随机访问文件的读入或同时用于读写，将已有文件作为RandomAccessFile打开时，这个文件不会被删除。</p>
<p>随机访问文件有一个表示下一个字节位置的文件指针，seek方法可以设置这个指针的位置，参数是一个long类型的整数，其值位于0到文件按照字节来度量的长度之间。</p>
<p>getFilePointer方法将返回文件指针的当前位置。</p>
<p>RandomAccessFile类同时实现了DataInput\DataOutput接口，可以使用前文提到的readInt\writeInt,readChar\writeChar等方法。</p>
<p>示例程序：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">package randomAccess;

import io.Employee;

import java.io.*;
import java.time.LocalDate;

public class randomAccessTest &#123;
    public static void main(String[] args) throws IOException &#123;
        Employee[] staff &#x3D; new Employee[3];
        staff[0] &#x3D; new Employee(&quot;Carl Cracker&quot;, 75000, 1987, 12, 15);
        staff[1] &#x3D; new Employee(&quot;Harry Hacker&quot;, 50000, 1989, 10, 1);
        staff[2] &#x3D; new Employee(&quot;Tony Tester&quot;, 40000, 1990, 3, 15);

        try (DataOutputStream out &#x3D; new DataOutputStream(new FileOutputStream(&quot;employee.dat&quot;))) &#123;
            for (Employee e : staff)
                writeData(out, e);
        &#125;

        try (RandomAccessFile in &#x3D; new RandomAccessFile(&quot;employee.dat&quot;, &quot;r&quot;)) &#123;
            int n &#x3D; (int) (in.length() &#x2F; Employee.RECORD_SIZE);
            Employee[] newStaff &#x3D; new Employee[n];

            for (int i &#x3D; n - 1; i &gt;&#x3D; 0; i--) &#123;
&#x2F;&#x2F;                newStaff[i] &#x3D; new Employee();
                in.seek(i * Employee.RECORD_SIZE);
                newStaff[i] &#x3D; readData(in);
            &#125;

            for (Employee e:staff)&#123;
                System.out.println(e);
            &#125;
        &#125;
    &#125;

    public static void writeData(DataOutput out, Employee e) throws IOException
    &#123;
        DataIO.writeFixedString(e.getName(), Employee.NAME_SIZE, out);
        out.writeDouble(e.getSalary());

        LocalDate hireDay &#x3D; e.getHireDay();
        out.writeInt(hireDay.getYear());
        out.writeInt(hireDay.getMonthValue());
        out.writeInt(hireDay.getDayOfMonth());
    &#125;

    public static Employee readData(DataInput in) throws IOException
    &#123;
        String name &#x3D; DataIO.readFixedString(Employee.NAME_SIZE, in);
        double salary &#x3D; in.readDouble();
        int y &#x3D; in.readInt();
        int m &#x3D; in.readInt();
        int d &#x3D; in.readInt();
        return new Employee(name, salary, y, m, d);
    &#125;

&#125;

package randomAccess;

import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;

public class DataIO &#123;
    public static void writeFixedString(String s, int size, DataOutput out) throws IOException
    &#123;
        for(int i &#x3D; 0; i &lt; size; i++)&#123;
            char ch &#x3D; 0;
            if(i&lt;s.length())
                ch &#x3D; s.charAt(i);
            out.writeChar(ch);
        &#125;
    &#125;

    public static String readFixedString(int size, DataInput in) throws IOException
    &#123;
        StringBuilder b &#x3D; new StringBuilder(size);
        int i &#x3D; 0;
        boolean more &#x3D; true;
        while(more &amp;&amp; i&lt;size)&#123;
            char ch &#x3D; in.readChar();
            i++;
            if (ch&#x3D;&#x3D;0) more &#x3D; false;
            else b.append(ch);
        &#125;
        in.skipBytes(2*(size-i));
        return b.toString();
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java">API java.io.RandomAccessFile
RandomAccessFile(String file, String mode)
RandomAccessFile(File file, String mode)
long getFilePointer()
返回文件指针的当前位置
void seek(long pos)
将文件指针设置到距文件开头pos个字节处
long length()
返回文件按照字节来度量的长度<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-3-zip文档"><a href="#3-3-zip文档" class="headerlink" title="3.3 zip文档"></a>3.3 zip文档</h3><p>zip文档以压缩格式存储了一个或多个文件，zip文档有一个头包含每个文件名字及所使用的压缩算法等信息，在Java中使用ZipInputStream来读入ZIP文档，如果需要浏览文档中的每个单独的项，getNextEntry方法就可以返回一个ZipEntry类型的对象 向ZipInputStream的getIuputStream方法传递该对象可以获取用于读取该项的输入流,然后调用closeEntry来读入下一项典型的通读ZIP文件的代码如下:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">ZipInputSream zin &#x3D; new ZipInputStream(new FileInputSream(zipname));
ZipEnery entry;
while((entry &#x3D; zin.getNextEntry()) !&#x3D; null)
&#123;
    InputStream in &#x3D; zin.getInputStream(entry);
    read the contents of in
    zin.closeEntry();
&#125;
zin.close();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>要写出到ZIP文件,使用ZipOutputStream,对于想要写入ZIP文件中的每一项,都应该创建一个ZipEntry对象,将文件名传递给ZipEntry的构造器,可以设置文件的日期和解压缩方法等参数,然后调用ZipOutputStream的putNextEntry方法来写出新文件,并将文件数据发送到ZIP输出流中,完成时调用closeEntry.代码框架如下:</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">FileOutputStream fout &#x3D; new FileOutputStream(&quot;test.zip&quot;);
ZipOutputStream zout &#x3D; new ZipOutputStream(fout);
for all files
&#123;
    ZipEntry ze &#x3D; new ZipEntry(filename);
    zout.putNextEntry(ze);
    send data to zout
    zout.closeEntry();
&#125;
zout.close();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java">API java.util.zip.ZipInputStream

ZipInputStream(InputStream in)
ZipEntry getNextEntry()
void closeEntry()

API java.util.zip.ZipOutputStream

ZipOutputStream(OutputStream out)
void putNextEntry(ZipEntry ze)
void closeEntry()
void setLevel(int level)
设置后续的各个DEFLATED项的默认压缩级别
void setMethod(int method)
设置默认压缩算法<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="4-操作文件"><a href="#4-操作文件" class="headerlink" title="4. 操作文件"></a>4. 操作文件</h2><p>Path接口和Files类封装了在用户机器上处理文件系统所需的所有功能。</p>
<h3 id="4-1-Path"><a href="#4-1-Path" class="headerlink" title="4.1 Path"></a>4.1 Path</h3><p>静态的Paths.get方法接受一个或多个字符串，并将他们用默认文件系统的路劲分隔符连接起来（类Unix文件系统是/,Windows是\），然后解析连接起来的结果，如果不是文件系统的合法路径就抛出InvalidPathException异常。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">Path absolute &#x3D; Paths.get(&quot;\\home&quot;, &quot;harry&quot;)
p.resolve(q)按照下列规则返回一个路径：
-如果q是一个绝对路径，结果就是q
-否则，将p后面跟着q作为结果
resolve方法也可以直接接收一个字符串
Path workPath &#x3D; basePath.resolve(&quot;work&quot;)
resolveSibling通过解析指定路径的父路径产生其兄弟路径，如workPath是\\opt\\myapp\\work
Path tempPath &#x3D; workPath.resolveSibling(&quot;temp&quot;)
将创建\\opt\\myapp\\temp
resolve的对立面是relativize，p.relativize(r)将产生路径q，而对q进行解析的结果正是r。如以、、home\\cay对目标\\home\\fred\\myprog进行相对化操作，将产生..\\fred\\myprog。
normalize方法移除所有冗余的.和..,如规范化\\home\cay\\..\\fred\\.\\myprog将产生\\home\\cay\\fred\\myprog。
toAbsolutePath方法将产生给定路径的绝对路径。绝对路径从根部件开始。
Path类的其他有用的方法：
Path p &#x3D; Paths.get(&quot;\\home&quot;, &quot;fred&quot;, &quot;myprog.properties&quot;);
Path parent &#x3D; p.getParent(); &#x2F;&#x2F;  \\home\\fred
Path file &#x3D; p.getFileName(); &#x2F;&#x2F; the path myprog.properties
Path root &#x3D; p.getRoot();  &#x2F;&#x2F; the path \\<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-2-读写文件"><a href="#4-2-读写文件" class="headerlink" title="4.2 读写文件"></a>4.2 读写文件</h3><p>Files类使得普通文件操作变得便捷。</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">byte[] bytes &#x3D; Files.readAllBytes(path);  读取文件的所有内容
String content &#x3D; new String(bytes, charset)
以行序列读入：
List&lt;String&gt; lines &#x3D; Files.readAllLines(path, charset);
写出一个字符串到文件中：
Files.write(path, content.getBytes(charset));
将一个行的集合写出到文件中：
Files.write(path, lines)
处理较大的文件或是二进制文件，还是使用输入\输出流或者读入器\写出器：
InputStream in &#x3D; Files.newInputStream(path)
OutputStream out &#x3D; Files.newOutputStream(path)
Reader in &#x3D; Files.newBufferedReader(path, charset)
Writer out &#x3D; Files.newBufferedWriter(path, charset)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-3-创建文件和目录"><a href="#4-3-创建文件和目录" class="headerlink" title="4.3 创建文件和目录"></a>4.3 创建文件和目录</h3><pre class="line-numbers language-none"><code class="language-none">创建新目录可以调用
Files.createDirectory(path);
其中路径中除最后一个部件外，其他部分必须是已存在的。要创建路径中的中间目录，应该使用
Files.createDirectories(path);
使用下面的语句创建一个空文件：
Files.createFile(path)
如果文件已经存在，那么就会抛出异常。
在给定位置或者系统指定位置创建临时文件或临时目录
Path newPath &#x3D; Files.createTempFile(dir, prefix, suffix)
Path newPath &#x3D; Files.createTempFile(prefixx, suffix)
Path newPath &#x3D; Files.createTempDirectory(dir, prefix)
Path newPath &#x3D; Files.createTempDirectory(prefix)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-4-复制移动和删除文件"><a href="#4-4-复制移动和删除文件" class="headerlink" title="4.4 复制移动和删除文件"></a>4.4 复制移动和删除文件</h3><pre class="line-numbers language-none"><code class="language-none">将文件从一个位置复制到另一个位置可以直接调用
Files.copy(fromPath, toPath);
移动文件可以调用
Files.move(fromPath, toPath);
如果目标路径已经存在那么移动或复制将失败，如果要覆盖已有的目标路径，可以使用REPLACE_EXISTING选项，要复制文件属性使用COPY_ATTRIBUTES选项。
Files.copy(fromPath, toPath, StandardCopyOption.REPLACE_EXISTING, StandardCopyOption.COPY_ATTRIBUTES);
可以将移动操作定义为原子性的，使用ATOMIC_MOVE选项来实现：
Files.move(fromPath, toPath, StandardCopyOption.ATOMIC_MOVE);
还可以将一个输入流复制到Path中，这表示将输入流存储到硬盘上，类似的可以将一个Path复制到输出流中，可以使用下面的调用：
Files.copy(inputStream, toPath)
Files.copy(fromPath, outputStream);
删除文件可以调用
Files.delete(path)
如果文件不存在这个方法就会抛出异常，可以使用下面的方法：
boolean deleted &#x3D; Files.deleteIfExists(path);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-5-获取文件信息"><a href="#4-5-获取文件信息" class="headerlink" title="4.5 获取文件信息"></a>4.5 获取文件信息</h3><pre class="line-numbers language-none"><code class="language-none">下面的静态方法都将返回一个boolean值，表示检查路径的某个属性的结果：
exists
isHidden
isReadable, isWritable, isExecutable
isRegularFile, isDirectory, isSymbolicLink
size方法将返回文件的字节数
long fileSize &#x3D; Files.size(path) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-6-访问目录中的项"><a href="#4-6-访问目录中的项" class="headerlink" title="4.6 访问目录中的项"></a>4.6 访问目录中的项</h3><pre class="line-numbers language-none"><code class="language-none">Files.list方法会返回一个可以读取目录中各个项的Stream&lt;Path&gt;对象，目录是被惰性读取的，这使得处理具有大量项的目录时更加高效。
因为读取目录涉及需要关闭的系统资源，所以应该使用try块：
try(Steam&lt;Path&gt; entris &#x3D; Files.list(pathToDirectory))
&#123;
    ...
&#125;
list方法不会进入子目录，为了处理目录中的所有子目录，需要使用File.walk方法。
try(Stream&lt;Path&gt; entries &#x3D; Files.walk(pathToRoot))
&#123;
    visited in depth-first order
&#125;
使用Files.walk方法来将一个目录复制到另一个目录：
Files.walk(source).forEach(p -&gt;
&#123;
    try
    &#123;
        Path q &#x3D; target.resolve(source.relativize(p));
        if (Files.isDirectory(q))
            Files.createDirectory(q);
        else
            Files.copy(p, q);
    &#125;
    catch (IOException ex)
    &#123;
        throw new UncheckedIOException(ex);
    &#125;
&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-7-使用目录流"><a href="#4-7-使用目录流" class="headerlink" title="4.7 使用目录流"></a>4.7 使用目录流</h3><pre class="line-numbers language-none"><code class="language-none">Files.walk方法会产生一个可以遍历目录中所有子孙的Stream&lt;Path&gt;对象。可以使用Files.newDirectoryStream，它产生一个DirectoryStream。它是Iterable的子接口，因此可以使用for循环。
try (DirectoryStream&lt;Path&gt; entries &#x3D; Files.newDirectoryStream(dir))
&#123;
    for (Path entry:entries)
        process entries
&#125;
（只遍历一级子目录）
可以使用glob模式来过滤文件：
try (DirectoryStream&lt;Path&gt; entries &#x3D; Files.newDirectoryStream(dir, &quot;*.java&quot;))

Files.walkFileTree方法可以访问某个目录的所有子孙目录，可以较方便地实现删除目录树，详细内容参见《Java核心技术 卷Ⅱ》第二章P93。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="4-8-ZIP文件系统"><a href="#4-8-ZIP文件系统" class="headerlink" title="4.8 ZIP文件系统"></a>4.8 ZIP文件系统</h3><pre class="line-numbers language-none"><code class="language-none">下面的调用
FileSystem fs &#x3D; FileSystem.newFileSystem(Paths.get(zipname), null);
将建立一个文件系统，它包含ZIP文档中的所有文件。如果知道文件名，那么从ZIP文档中复制出这个文件就很容易：
Files.copy(fs.getPath(sourceName), targetPath);
其中fs.getPath对于任意文件系统来说都与Paths.get类似。
要列出ZIP文档中的所有文件，可以遍历文件树：
FileSystem fs &#x3D; FileSystems.newFileSystem(Paths.get(zipname), null);
Files.walkFileTree(fs.getPath(&quot;&#x2F;&quot;), new SimpleFileVisitor&lt;Path&gt;()
&#123;
    public FileVisitResult visitFile(Path file, BasicFileAttributes attrs) throws IOException
    &#123;
        System.out.println(file);
        return FileVisitResult.CONTINUE;
    &#125;
&#125;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="5-内存映射文件"><a href="#5-内存映射文件" class="headerlink" title="5. 内存映射文件"></a>5. 内存映射文件</h2><h3 id="5-1-内存映射文件性能"><a href="#5-1-内存映射文件性能" class="headerlink" title="5.1 内存映射文件性能"></a>5.1 内存映射文件性能</h3><p>java.nio包使得内存映射变得十分简单，首先从文件获得一个通道（channel），通道是用于磁盘文件的一种抽象。然后通过调用FileChannel类的map方法从这个通道获得一个ByteBuffer。可以指定想要映射的文件区域和映射模式，一旦有了缓冲区，就可以使用ByteBuffer类的Buffer超类的方法读写数据了。</p>
<pre class="line-numbers language-none"><code class="language-none">FileChannel channel &#x3D; FileChannel.open(path, options);
ByteBuffer buffer &#x3D; channel.map(FileChannel.MapMode.READ_ONLY, 0, length);
...
While (buffer.hasRemaining())
&#123;
    byte b &#x3D; buffer.get();
    ...
&#125;

for (int i&#x3D;0; i&lt;buffer.limit(); i++)
&#123;
    byte b &#x3D; buffer.get(i);
    ...
&#125;

读写字节数组：
get(byte[] bytes)
get(byte[], int offset, int length)

其他一些方法用来读入在文件中存储为二进制的基本类型值：
getInt
getLong
getShort
...
要向缓冲区写数字，使用：
putInt
putLong
putShort
在恰当的时机，以及当通道关闭时，会将这些修改写回到文件中。


示例程序：
package memoryMap;

import java.io.BufferedInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.RandomAccessFile;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.zip.CRC32;

public class MemoryMapTest &#123;
    public static long checksumInputStream(Path fielname) throws IOException
    &#123;
        try (InputStream in &#x3D; Files.newInputStream(fielname))
        &#123;
            CRC32 crc &#x3D; new CRC32();

            int c;
            while((c&#x3D;in.read()) !&#x3D; -1)
                crc.update(c);
            return crc.getValue();
        &#125;
    &#125;

    public static long checksumBufferedInputStream(Path filename) throws IOException
    &#123;
        try (InputStream in &#x3D; new BufferedInputStream(Files.newInputStream(filename)))
        &#123;
            CRC32 crc &#x3D; new CRC32();

            int c;
            while((c&#x3D;in.read()) !&#x3D; -1)
                crc.update(c);
            return crc.getValue();
        &#125;
    &#125;

    public static long checksumRandomAccessFile(Path filename) throws IOException
    &#123;
        try (RandomAccessFile file &#x3D; new RandomAccessFile(filename.toFile(), &quot;r&quot;))
        &#123;
            long length &#x3D; file.length();
            CRC32 crc &#x3D; new CRC32();

            for (long p &#x3D; 0; p &lt; length; p++)
            &#123;
                file.seek(p);
                int c &#x3D; file.readByte();
                crc.update(c);
            &#125;
            return crc.getValue();
        &#125;
    &#125;

    public static long checksumMappedFile(Path filename) throws IOException
    &#123;
        try(FileChannel channel &#x3D; FileChannel.open(filename))
        &#123;
            CRC32 crc &#x3D; new CRC32();
            int length &#x3D; (int) channel.size();
            MappedByteBuffer buffer &#x3D; channel.map(FileChannel.MapMode.READ_ONLY, 0, length);

            for (int p &#x3D; 0; p &lt; length; p++)
            &#123;
                int c &#x3D; buffer.get(p);
                crc.update(c);
            &#125;
            return crc.getValue();
        &#125;
    &#125;

    public static void main(String[] args) throws IOException
    &#123;
        System.out.println(&quot;Input Stream:&quot;);
        long start &#x3D; System.currentTimeMillis();
        Path filename &#x3D; Paths.get(args[0]);
        long crcValue &#x3D; checksumInputStream(filename);
        long end &#x3D; System.currentTimeMillis();
        System.out.println(Long.toHexString(crcValue));
        System.out.println((end-start) + &quot; milliseconds&quot;);

        System.out.println(&quot;Buffered Input Stream:&quot;);
        start &#x3D; System.currentTimeMillis();
        crcValue &#x3D; checksumInputStream(filename);
        end &#x3D; System.currentTimeMillis();
        System.out.println(Long.toHexString(crcValue));
        System.out.println((end-start) + &quot; milliseconds&quot;);

        System.out.println(&quot;Input Stream:&quot;);
        start &#x3D; System.currentTimeMillis();
        crcValue &#x3D; checksumInputStream(filename);
        end &#x3D; System.currentTimeMillis();
        System.out.println(Long.toHexString(crcValue));
        System.out.println((end-start) + &quot; milliseconds&quot;);

        System.out.println(&quot;Input Stream:&quot;);
        start &#x3D; System.currentTimeMillis();
        crcValue &#x3D; checksumInputStream(filename);
        end &#x3D; System.currentTimeMillis();
        System.out.println(Long.toHexString(crcValue));
        System.out.println((end-start) + &quot; milliseconds&quot;);
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="5-2-缓冲区数据结构"><a href="#5-2-缓冲区数据结构" class="headerlink" title="5.2 缓冲区数据结构"></a>5.2 缓冲区数据结构</h3><p>在使用内存映射时可以使用更多的缓冲区来读写大小适度的信息块。<br>缓冲区是由具有相同类型的数值构成的数组，Buffer类是一个抽象类，它有众多的具体子类，包括ByteBuffer、CharBuffer、DoubleBuffer、IntBuffer、LongBuffer…<br>实际中最常用的是ByteBuffer、CharBuffer，每个缓冲区都具有：</p>
<ul>
<li>一个容量</li>
<li>一个读写位置，下一个值将在此进行读写</li>
<li>一个界限，超过它读写是没有意义的</li>
<li>一个可选的标记，用于重复一个读写操作</li>
</ul>
<p>假设我们有一个缓冲区，在一开始他的位置是0，界限等于容量。我们不断地调用put将值添加到这个缓冲区，当我们耗尽所有的数据或者写出的数据量达到容量大小时，就该切换到读入操作了。这时调用flip方法将界限设置到当前位置，并把位置复位到0，在remaining方法返回正数时（界限-位置）不断调用get，将缓冲区所有的值都读入之后，调用clean使缓冲区为下一次写循环做好准备。clean方法将位置复位到0，并将界限复位到容量。</p>
<p>要获取缓冲区，可以调用ByteBuffer.allocate或ByteBuffer.wrap这样的静态方法：</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java">ByteBuffer buffer &#x3D; ByteBuffer.allocate(RECORD_SIZE);
channel.read(buffer);
channel.position(newpos);
buffer.flip();
channel.write(buffer);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>







                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">GJ</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://gj2033.github.io/2021/061716115.html">https://gj2033.github.io/2021/061716115.html</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">GJ</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="far fa-dot-circle"></i>&nbsp;本篇
            </div>
            <div class="card">
                <a href="/2021/061716115.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="反射">
                        
                        <span class="card-title">反射</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-06-17
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            GJ
                            
                        </span>
                    </div>
                </div>

                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/031116114.html">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="反射">
                        
                        <span class="card-title">反射</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-11
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            GJ
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        font-size: 15px;
        color: #42b983;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="58925479"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='false'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2021</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">GJ</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/GJ2033" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:GJ2033@outlook.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=443217109" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 443217109" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
